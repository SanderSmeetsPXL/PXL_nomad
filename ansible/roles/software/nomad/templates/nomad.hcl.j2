datacenter = "dc1"
data_dir = "/opt/nomad"
log_level = "DEBUG"
name = "{{ inventory_hostname }}"
bind_addr = "{{ ansible_eth1.ipv4.address }}"


{% if "servers" in group_names %}
server {
	enabled = true
	bootstrap_expect = 1
}
{% else %}
client {
	enabled = true
	network_interface = "eth1"
	alloc_dir = "/tmp/nomad-allocations"
    options = {
    "docker.volumes.enabled" = true
    }

}

plugin "docker" {
    config {
#       allow_caps = [ "CHOWN,DAC_OVERRIDE,FSETID,FOWNER,MKNOD,NET_RAW,SETGID,SETUID,SETFCAP,SETPCAP,NET_BIND_SERVICE,SYS_CHROOT,KILL,AUDIT_WRITE,NET_ADMIN" ]
       allow_caps = [ "ALL" ]
    }
}


{% endif %}

